from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import os
from sklearn.tree import plot_tree
from sklearn.tree import export_graphviz
import graphviz

def train_random_forest(data, labels):
    """
    Trains a Random Forest classifier on the provided data and labels.

    :param data: List of lists containing feature data (each inner list should contain 5 fields).
    :param labels: List of boolean values indicating the target variable (True/False).
    :return: Trained Random Forest model.
    """
    # Convert data and labels to numpy arrays
    X = np.array(data)
    y = np.array(labels)

    # Ensure that the feature set has exactly 5 fields per example
    if X.shape[1] != 5:
        raise ValueError("Each inner list in 'data' must contain exactly 5 fields.")

    # Splitting arrays into random train and test subsets (70% train, 30% test)
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=58)

    # Creating a Random Forest classifier
    clf = RandomForestClassifier(n_estimators=100)

    # Training the model on the training dataset
    clf.fit(X_train, y_train)

    # Perform predictions on the test dataset
    y_pred = clf.predict(X_test)

    # Print metrics for accuracy calculation
    from sklearn import metrics
    print("Accuracy of the model:", metrics.accuracy_score(y_test, y_pred))
    from sklearn.metrics import classification_report

    print(classification_report(y_test, y_pred))
    print(clf.feature_importances_)
    
        


    return clf  # Return the trained model

# Example usage
if __name__ == "__main__":
    # Example data: list of lists (each inner list has 5 fields)
#     example_data = [[73374, 19516, 66.17392549039656, 2.4865298505464495e-18, 4.8527116563264506e-14], [12735, 19173, 39.14556222756553, 7.976772251135083e-19, 1.5293865437101295e-14], [73004, 19960, 44.04449368875055, 1.2337741438916345e-18, 2.4626131912077022e-14], 
# [4525, 22606, 53.59326433219393, 1.672264464554961e-18, 3.780321048572945e-14], [52113, 29775, 29.21825849451307, 6.597095162820474e-19, 1.964285084729796e-14], [68342, 17719, 79.36209914844828, 8.6572173505819e-18, 1.5339723423496068e-13],
# [72120, 20420, 105.46293977176782, 6.703629353398982e-17, 1.368881113964072e-12], [18380, 20507, 73.49346086608784, 1.214539665291525e-17, 2.4906564916133305e-13], [42189, 5497, 6.839583227007102, 2.7477787357006605e-18, 1.510453971014653e-14], 
# [18380, 20507, 73.49346086608784, 1.214539665291525e-17, 2.4906564916133305e-13], [42189, 5497, 6.839583227007102, 2.7477787357006605e-18, 1.510453971014653e-14], [71860, 20672, 39.68131699586226, 8.3852386187417595e-19, 1.7333965272662965e-14],
# [41422, 29794, 24.178898939574925, 4.77873179805441e-19, 1.423775351912331e-14], [62073, 2800, 25.62602731584809, 1.5059000468803565e-17, 4.2165201312649985e-14], [46291, 22610, 58.009107787533694, 1.3494611430908336e-18, 3.051131644528375e-14],
# [26582, 20195, 45.058050723443756, 7.525183275254872e-19, 1.5197107624377213e-14], [73974, 17432, 41.54931788915631, 1.343001896545486e-18, 2.3411209060580912e-14], [56477, 15545, 38.995333338021545, 9.53058348795793e-19, 1.48152920320306e-14],
# [45617, 23529, 53.917853706884124, 1.6210966651394173e-18, 3.814278343406535e-14], [53886, 10684, 21.695689421408353, 8.63279701131072e-19, 9.223280326884374e-15], [42937, 1314, 56.94184604234445, 7.092947791143017e-17, 9.320133397561925e-14], 
# [65732, 25647, 25.948122061802174, 4.6032835781128535e-19, 1.1806041392786036e-14], [55838, 1438, 4.896261070952537, 5.424743715227665e-18, 7.800781462497382e-15], [13285, 26507, 41.05884165796437, 7.41663877544262e-19, 1.9659284402065753e-14], 
# [54632, 29703, 23.43237081982058, 5.548347815611685e-19, 1.6480257516711388e-14], [36739, 23587, 54.186470228060024, 1.485351505641816e-17, 3.5034985963573515e-13], [25466, 14318, 137.26498028206862, 2.0546430966300598e-17, 2.94183798575492e-13], 
# [35053, 25203, 45.92382102818788, 3.3119536382702797e-18, 8.347116754532586e-14], [29031, 9003, 23.529021480789037, 2.8108882186790652e-18, 2.5306426632767623e-14], [35053, 25203, 45.92382102818788, 3.3119536382702797e-18, 8.347116754532586e-14], 
# [29031, 9003, 23.529021480789037, 2.8108882186790652e-18, 2.5306426632767623e-14], [8555, 51960, 18.37138325290266, 1.8622299427430846e-19, 9.676146782493068e-15], [80348, 15356, 91.81772690508954, 8.038523023367001e-16, 1.2343955954682366e-11], 
# [39071, 20721, 89.47455497218877, 9.765767048054625e-16, 2.023564590027399e-11], [77626, 24190, 2.5733877052750516, 6.284533700950327e-20, 1.520228702259884e-15], [32102, 23081, 21.197617394046315, 2.4742375463039173e-19, 5.710787680624072e-15], 
# [42047, 16239, 5.083808127259287, 9.574765434101282e-20, 1.5548461588437073e-15], [60141, 14420, 2.5600289623129413, 5.1011873002281005e-20, 7.355912086928921e-16], [12003, 24235, 34.53227023907869, 1.3746402991108257e-18, 3.331440764895086e-14], 
# [55754, 1438, 51.272506022218586, 6.039285866322063e-17, 8.684493075771126e-14], [65278, 21192, 82.36876182861943, 7.387114977038297e-17, 1.5654774059339558e-12], [19777, 24604, 43.36335520976709, 1.7937341653060387e-18, 4.4133035403189775e-14], 
# [15173, 24253, 27.44486578694629, 4.166819385176262e-19, 1.0105787054867988e-14], [23713, 20460, 52.82655300060642, 1.0266386386583283e-18, 2.1005026546949397e-14], [1587, 2064, 2.6294848638295254, 1.019153301502279e-19, 2.1035324143007038e-16], 
# [64655, 17685, 32.97586737796324, 4.402704769437765e-19, 7.786183384750688e-15], [48830, 23971, 60.24342063799708, 3.1668149348705882e-18, 7.591172080378287e-14], [77396, 1171, 6.4131371180057695, 1.2376937190894045e-17, 1.4493393450536927e-14], 
# [58244, 22375, 32.968024225954615, 6.406534194281304e-19, 1.433462025970442e-14], [79056, 23240, 71.79049901729995, 5.639178126019225e-17, 1.3105449964868677e-12], [28925, 1739, 2.7304950638915875, 1.936740723818587e-18, 3.367992118720523e-15], 
# [79056, 23240, 71.79049901729995, 5.639178126019225e-17, 1.3105449964868677e-12], [28925, 1739, 2.7304950638915875, 1.936740723818587e-18, 3.367992118720523e-15], [8558, 21694, 39.47066311072109, 5.852173507538954e-19, 1.2695705207255008e-14],  
# [65452, 21763, 55.85678869746913, 4.237428631638206e-18, 9.221915931034229e-14], [28352, 303069, 12.95570911011172, 8.909379957830716e-20, 2.7001568744397972e-14], [77409, 29572, 10.437523967905081, 2.4847699319812945e-19, 7.347961642855084e-15], 
# [7439, 39734, 22.540539207253047, 2.149796647426919e-19, 8.54200199888612e-15], [16637, 38355, 2.833233896570098, 6.026933698703982e-20, 2.311630420137912e-15], [22577, 38007, 3.279655018076612, 5.630127346246764e-20, 2.1398425004880075e-15], 
# [81255, 28569, 25.048422559418817, 1.6498448168359815e-19, 4.7134416572187155e-15], [75570, 19731, 2.5863963307082654, 5.2447089751131724e-20, 1.03483352787958e-15], [875, 14083, 2.6139557954791957, 4.097325953759903e-20, 5.770264140680071e-16], 
# [65762, 13167, 3.787232164664552, 4.757486762489116e-20, 6.26418282016942e-16], [1892, 31420, 32.59482472466378, 1.7443527070317468e-19, 5.480756205493748e-15], [14975, 11599, 3.1332436569967945, 5.4191094435626813e-20, 6.285625043588354e-16], 
# [78191, 8320, 4.965940254130458, 7.073476009940334e-20, 5.885132040270358e-16], [8865, 6451, 3.491758092208157, 4.963965758864754e-20, 3.2022543110436525e-16], [824, 49445, 3.0273626958082804, 6.898222213133678e-20, 3.4108259732839473e-15], 
# [8329, 42064, 2.8017820615176805, 5.2675388770351466e-20, 2.215737553236064e-15], [25990, 21470, 16.05305789478061, 1.5243030207720754e-19, 3.2726785855976458e-15], [19545, 10672, 2.7959353729133074, 5.220679554805642e-20, 5.571509220888581e-16],
# [40591, 10179, 2.7518489449435024, 4.239835431050937e-20, 4.3157284852667487e-16], [35372, 1780, 2.5488778625151225, 3.60418800959837e-20, 6.415454657085098e-17], [28995, 7336, 164.51546879898063, 2.971767309374168e-16, 2.1800884981568895e-12], 
# [69738, 25098, 36.339932903932166, 9.194561986881199e-19, 2.3076511674674433e-14], [2580, 5434, 120.26298519978216, 1.1390372156152793e-18, 6.189528229653428e-15]] 


#     # Example labels: True/False for each example
#     example_labels = [True, True, True, 
#                     True, True, True, 
#                     True, True, True, 
#                     True, True, True,
#                     True, False, True,
#                     True, True, True,
#                     True, True, False,
#                     True, False, True,
#                     True, True, True,
#                     True, True, True, 
#                     True, True, True,
#                     True, False, True,
#                     False, False, True,
#                     False, True, True,
#                     True, True, False,
#                     True, True, False,
#                     True, True, True,
#                     True, True, True,
#                     True, True, True,
#                     True, False, False,
#                     True, False, False,
#                     False, True, False,
#                     False, False, False,
#                     False, True, False,
#                     False, False, True,
#                     True, True]
    example_data = [[73360, 21011, 124.99950430053812, 2.3358511276811936e-18, 4.907856804370956e-14], [12738, 19014, 123.19346504360149, 8.023779162639725e-19, 1.5256413699843173e-14], [73004, 19934, 123.98472684524646, 1.2351944161828952e-18, 2.4622365492189832e-14],
[4524, 22751, 124.63042397587621, 1.6629161926215846e-18, 3.783300629833367e-14], [52118, 27085, 123.41725921647404, 7.077939546334124e-19, 1.9170599261245976e-14], [68338, 19206, 124.72673258952969, 8.04073843257998e-18, 1.5443042233613112e-13],
[72089, 22438, 124.70046378869993, 6.156206599936137e-17, 1.3813296368936705e-12], [18357, 20881, 124.88884083781193, 1.1954987629089202e-17, 2.496320966830116e-13], [42174, 6989, 9.990196113485924, 2.4793325880144418e-18, 1.7328055457632935e-14],
[18357, 20881, 124.88884083781193, 1.1954987629089202e-17, 2.496320966830116e-13], [42174, 6989, 9.990196113485924, 2.4793325880144418e-18, 1.7328055457632935e-14], [71865, 19175, 124.85507927030672, 8.91204832951928e-19, 1.708885267185322e-14],
[41449, 21680, 117.01654940636634, 5.963964990855694e-19, 1.2929876100175145e-14], [46271, 23191, 124.79359479193678, 1.3191594860545886e-18, 3.0592627641091966e-14], [26582, 20192, 124.88762021951253, 7.525982383651376e-19, 1.519646362906886e-14],
[73975, 16293, 124.75287447395449, 1.4207318729718915e-18, 2.314798440633103e-14], [56478, 15386, 124.64435769557413, 9.608615372861936e-19, 1.4783815612685375e-14], [9541, 4617, 4.358027624891055, 1.257946536075142e-19, 5.807939157058931e-16],
[45606, 25050, 124.35773153245867, 1.5378528113356332e-18, 3.852321292395761e-14], [53880, 10919, 45.92261869347565, 8.486610205407561e-19, 9.266529683284515e-15], [31719, 3737, 3.1517786302251944, 1.3613869134480425e-19, 5.087502895555335e-16],
[66024, 21223, 124.08778524412662, 5.376692250394156e-19, 1.1410953963011518e-14], [13289, 26428, 123.91949262301965, 7.435901907786856e-19, 1.9651601561899103e-14], [55042, 19793, 123.7835932863412, 7.67369453092829e-19, 1.5188543585066364e-14],
[36735, 23769, 124.54309814683961, 1.4795484263208975e-17, 3.5167386545221413e-13], [25432, 18357, 124.88143500930317, 1.6676169290068098e-17, 3.061244396577801e-13], [35053, 25221, 124.94003802816816, 3.3098069243423666e-18, 8.347664043883883e-14], 
[29031, 9012, 62.6604411502873, 2.8083689344330668e-18, 2.5309020837110798e-14], [35053, 25221, 124.94003802816816, 3.3098069243423666e-18, 8.347664043883883e-14], [29031, 9012, 62.6604411502873, 2.8083689344330668e-18, 2.5309020837110798e-14],
[10704, 17353, 123.71970485524132, 4.2805071642647264e-19, 7.42796408214858e-15], [57747, 4707, 4.856530416568878, 2.058649289778584e-19, 9.690062206987795e-16], [69510, 4376, 4.716678691173902, 1.6114816450657628e-19, 7.051843678807778e-16], 
[42630, 4228, 7.9999017529337415, 1.1978452003502434e-19, 5.064489507080829e-16], [80346, 16836, 124.39173572819824, 7.382059002111155e-16, 1.2428434535954341e-11], [39061, 20876, 123.94856526861064, 9.713374521726215e-16, 2.027764065155565e-11],
[32192, 19370, 124.84439141374085, 2.8335202409682106e-19, 5.488528706755424e-15], [79318, 12539, 9.29434339200685, 6.367768170700584e-20, 7.984544509241462e-16], [42095, 11517, 25.083083094682426, 1.1345151374511179e-19, 1.3066210838024525e-15], 
[72605, 7541, 8.604481483169188, 6.389072598291009e-20, 4.81799964637125e-16], [60165, 3220, 9.59407678952798, 6.238411714672383e-20, 2.0087685721245073e-16], [11992, 24606, 83.31134305413077, 1.3564783163084172e-18, 3.3377505451084916e-14],
[65261, 22826, 124.94161708733242, 6.90286464546236e-17, 1.5756478839732382e-12], [19779, 24551, 124.46800894243668, 1.7972868699994228e-18, 4.4125189945355825e-14], [15346, 21683, 124.5131995104303, 4.568529246668252e-19, 9.90594196555077e-15], 
[71664, 4566, 4.252365616003273, 7.70450050694582e-20, 3.5178749314714614e-16], [23705, 20737, 124.95057967373656, 1.0157083624589534e-18, 2.106274431231132e-14], [1580, 3969, 3.9244205306859556, 9.727654265966499e-20, 3.860905978162104e-16],
[64734, 16410, 124.65588539301812, 4.70517436772977e-19, 7.721191137444552e-15], [48825, 26674, 124.56939380835335, 2.894671805162631e-18, 7.721247573090802e-14], [58271, 18958, 123.40026553535832, 7.350065682244018e-19, 1.393425452039821e-14],
[79042, 24099, 124.80859558750622, 5.483006714807511e-17, 1.3213497882014622e-12], [28490, 6351, 3.051898730348294, 1.8085387559702434e-18, 1.1486029639167017e-14], [79042, 24099, 124.80859558750622, 5.483006714807511e-17, 1.3213497882014622e-12], 
[28490, 6351, 3.051898730348294, 1.8085387559702434e-18, 1.1486029639167017e-14], [8572, 21048, 124.9373246920834, 6.002278716186885e-19, 1.2633596241830154e-14], [65443, 25046, 124.78418150401521, 3.7438944253598964e-18, 9.376957977756396e-14],
[78138, 19196, 98.21470688421164, 3.3967209405081953e-19, 6.5203455173995314e-15], [28681, 16120, 123.72003869781759, 3.5973061163480767e-19, 5.7988574595530994e-15], [9309, 19276, 124.6807464451674, 3.750998412902408e-19, 7.230424540710682e-15],
[12241, 28502, 8.226023224757999, 5.0570268622222096e-20, 1.4413537962705742e-15], [24624, 24219, 8.327965394866718, 5.612438311912653e-20, 1.3592764347621256e-15], [18331, 19548, 9.492670394206524, 6.029016172068375e-20, 1.178552081315926e-15], 
[82570, 19203, 124.62702500153154, 2.2512071852572883e-19, 4.3229931578495706e-15], [65840, 11173, 14.412139140685117, 5.072847363999468e-20, 5.667892359796605e-16], [76930, 9272, 6.544042753007235, 5.389439592231562e-20, 4.997088389917104e-16], 
[1371, 8146, 8.255855463687801, 4.906942233172604e-20, 3.9971951431424036e-16], [2394, 27975, 123.02364771414642, 1.9019402666382872e-19, 5.3206778959206085e-15], [14998, 11299, 8.402513222050361, 5.495056700649759e-20, 6.208864566064163e-16], 
[78221, 8011, 15.674654763372699, 7.273947335549043e-20, 5.827159210508338e-16], [8884, 6069, 9.719344520466796, 5.030144772891785e-20, 3.0527948626680244e-16], [26046, 20690, 124.55321611502613, 1.5658603878767532e-19, 3.2397651425170026e-15], 
[1387, 20423, 13.949523974197051, 6.07452523966121e-20, 1.2406002896960087e-15], [10464, 10178, 10.87128395719838, 5.839821394660011e-20, 5.943770215484959e-16], [19602, 6442, 14.89133580924957, 5.764434400112495e-20, 3.713448640552469e-16],
[28919, 11794, 124.77240276506379, 1.9348998163146056e-16, 2.282020843361446e-12], [69748, 21256, 124.39918619344022, 1.0439816902751674e-18, 2.2190874808488956e-14], [2575, 6206, 124.57887076102703, 1.0130188511973426e-18, 6.286794990530708e-15], 
[2495, 9287, 115.63771959911735, 58226.79504051623, 540752245.5412742], [633, 7272, 122.46327273276843, 106906.28284887955, 777422488.8770521], [9582, 24978, 84.0369296499171, 3.1367014388043817e-19, 7.834852853845585e-15], 
[40203, 19911, 124.18139567355325, 3.624580507288221e-19, 7.216902248061577e-15], [9582, 24978, 84.0369296499171, 3.1367014388043817e-19, 7.834852853845585e-15], [40203, 19911, 124.18139567355325, 3.624580507288221e-19, 7.216902248061577e-15],
[2024, 21728, 8.228284733348973, 4.7865948667761137e-20, 1.040031332653114e-15], [40552, 20828, 8.894406267244287, 7.882737971388488e-20, 1.6418166646807943e-15], [32189, 12397, 8.186653164259322, 6.721568134028738e-20, 8.332728015755426e-16], 
[48722, 6921, 6.196901923103209, 4.606781010142538e-20, 3.1883531371196505e-16], [13921, 4670, 5.757203859182437, 6.649262336936612e-20, 3.1052055113493977e-16], [25993, 2, 1.004060907811847, 9.863111371728336e-21, 1.972622274345667e-20],
[66957, 23022, 124.81344858893786, 3.9076259024480373e-19, 8.996136352615872e-15], [65695, 27035, 124.73500208346634, 5.793838421539452e-19, 1.5663642172631907e-14], [11180, 6384, 5.625448588054143, 1.1898332746368162e-19, 7.595895625281435e-16], 
[31067, 4785, 6.142054441984899, 7.492139628223192e-20, 3.584988812104797e-16], [10036, 34525, 124.65064629859089, 2.684359821878194e-19, 9.267752285034463e-15], [18931, 11938, 12.776694029593502, 6.415394237695346e-20, 7.658697640960704e-16], 
[32648, 7755, 13.211250452629685, 5.97863968436399e-20, 4.6364350752242745e-16], [50222, 3330, 5.282649637580155, 4.9107316472154976e-20, 1.6352736385227606e-16], [28781, 38804, 94.72617988053968, 1.1034232512824922e-19, 4.281723584276583e-15], 
[68023, 17592, 124.50252910533104, 1.8791780058565408e-19, 3.3058499479028266e-15], [34779, 13949, 9.311104921769154, 8.429187133766479e-20, 1.1757873132890861e-15], [41952, 6354, 6.0938594295849775, 4.513821240266558e-20, 2.8680820160653707e-16], 
[62573, 3987, 6.356822728758196, 5.031814014729923e-20, 2.0061842476728202e-16], [2952, 16426, 124.8181641179516, 7.837572862416289e-18, 1.2873997183804996e-13], [60973, 11364, 26.558360210424205, 4.824171558727998e-20, 5.482188559338497e-16], 
[84543, 8712, 124.65926469083493, 2.0258873628311916e-19, 1.7649530704985341e-15], [66773, 6562, 8.110385403647113, 2.8617724430448895e-20, 1.8778950771260566e-16], [44283, 24879, 124.48299046764683, 1.5423795535682478e-18, 3.8372860913224437e-14],
[84087, 11208, 122.92864974303241, 6.172562551792517e-19, 6.9182081080490535e-15], [22835, 18021, 124.64594505449831, 2.3705112986352586e-18, 4.2718984112705996e-14], [80963, 8730, 124.88177328667796, 2.4304267860561314e-17, 2.1217625842270026e-13],
[61129, 28274, 124.40207083623413, 3.047726992454604e-19, 8.617143298466147e-15], [52234, 14412, 12.633821222057957, 7.91235288499951e-20, 1.1403282977861294e-15], [43132, 6629, 11.217065531747306, 6.17204528115533e-20, 4.0914488168778683e-16],
[31114, 17062, 124.10602111597095, 3.3263707806808376e-19, 5.675453825997645e-15], [52461, 5656, 6.045167365206823, 7.505673279570969e-20, 4.24520880692534e-16], [66618, 23646, 124.97500293658968, 3.3335943540962368e-18, 7.882617209695961e-14],
[33471, 12285, 124.39999360821686, 5.097649829317519e-19, 6.262462815316572e-15], [642, 11888, 28.424228122145163, 1.5414723187455388e-19, 1.8325022925246966e-15], [80038, 3593, 6.507026503685567, 7.419699336504813e-20, 2.6658979716061793e-16],
[51489, 17561, 119.87160893565904, 2.995700732915604e-19, 5.260750057073093e-15], [80543, 9874, 25.560288066291598, 1.0289774163006216e-19, 1.0160123008552338e-15], [1565, 15308, 113.51981774644766, 3.195003700461872e-19, 4.890911664667034e-15], 
[38131, 6322, 29.891037554774538, 8.697681432920407e-20, 5.498674201892281e-16], [32662, 3613, 20.081646710613395, 8.013392165116333e-20, 2.895238589256531e-16], [23724, 3596, 23.459406646230207, 8.354168288945283e-20, 3.004158916704724e-16], 
[17011, 3046, 16.792813245841273, 7.990295511754033e-20, 2.4338440128802785e-16], [10609, 24599, 124.59397686764764, 8.045371872996086e-19, 1.9790810270383072e-14], [51441, 17116, 27.057512678255513, 3.27095751006716e-19, 5.598570874230951e-15],
[10609, 24599, 124.59397686764764, 8.045371872996086e-19, 1.9790810270383072e-14], [51441, 17116, 27.057512678255513, 3.27095751006716e-19, 5.598570874230951e-15], [3044, 21419, 124.50688729163518, 1.6378432861700397e-18, 3.508096534647608e-14],
[43638, 21406, 123.00352830055729, 9.716290803944993e-19, 2.079869209492465e-14], [63722, 19203, 124.69654549887122, 1.6101228591677723e-18, 3.091918926459873e-14], [65837, 21107, 124.87324538217894, 1.3308972322165702e-16, 2.809124788039515e-12],
[36285, 19721, 124.01497162541764, 5.956713011494165e-16, 1.1747233729967643e-11], [65729, 7202, 3.046475540032945, 1.697100713958279e-19, 1.2222519341927525e-15], [57686, 5968, 124.87961710104908, 1.4066356163353154e-18, 8.394801358289162e-15],
[12350, 23548, 123.30563351688275, 4.577660586049652e-19, 1.0779475148029721e-14], [47896, 15530, 40.80040779839375, 1.3318709425447863e-19, 2.068395573772053e-15], [32473, 10633, 13.74357454437658, 9.394935725671945e-20, 9.98963515710698e-16], 
[58230, 4246, 5.273111202353928, 6.683004961014492e-20, 2.837603906446753e-16]]
    
    example_labels = [True, True, True,
True, True, True,
True, True, True,
True, True, True,
True, True, True,
True, True, False,
True, True, False,
True, True, True, 
True, True, True,
True, True, True,
True, False, False,
False, True, True,
True, False, False,
False, False, True,
True, True, True, 
False, True, False,
True, True, True,
True, True, True,
True, True, True,
True, True, True,
False, False, False,
True, False, False,
False, True, False,
False, False, True,
False, False, False,
True, True, True,
True, True, True,
True, True, True,
True, False, False,
False, False, False,
True, True, False,
False, True, False,
False, False, True,
True, False, False, 
False, True, False,
True, False, True,
True, True, True,
True, False, False,
True, False, True,
True, False, False,
True, False, True,
False, False, False,
False, True, True,
True, True, True,
True, True, True,
True, False, True,
True, False, False,
False]
    # Train the model
    model = train_random_forest(example_data, example_labels)
    # plt.figure(figsize=(20, 10))
    # plot_tree(model.estimators_[0], filled=True, feature_names=["time", "duration", "a", "power", "energy"], rounded=True)
    # plt.title("First Tree in Random Forest")
    # plt.show()
    # importances = model.feature_importances_
    # indices = np.argsort(importances)[::-1]
    # # Plot the feature importances of the forest
    # plt.figure(figsize=(10, 6))
    # plt.title("Feature Importances")
    # plt.bar(range(len(importances)), importances[indices], align='center')
    # plt.xticks(range(len(importances)), np.array(["time", "duration", "a", "power", "energy"])[indices], rotation=90)
    # plt.xlim([-1, len(importances)])
    # plt.show()
    # # Export the first tree to a .dot file
    save_directory = os.path.expanduser('~/Downloads')
    output_file_path = os.path.join(save_directory, "tree")

    # Export the first tree to a .dot file
    dot_data = export_graphviz(
        model.estimators_[0],
        out_file=None,
        feature_names=["time", "duration", "a", "power", "energy"],
        class_names=['False', 'True'],
        filled=True,
        rounded=True,
        special_characters=True
    )

    # Create a Graphviz source object and render it
    graph = graphviz.Source(dot_data)
    graph.render(output_file_path, format='pdf')  # Saves the tree as a PDF
